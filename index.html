<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>До переворота календаря осталось…</title>
  <style>
    :root{
      --bg1: #0f172a;
      --bg2: #1e293b;
      --accent: #60a5fa;
      --text: #e5e7eb;
      --muted: #94a3b8;
      --card: rgba(255,255,255,0.08);
      --blur: 14px;
      --radius: 16px;
    }
    @media (prefers-color-scheme: light) {
      :root{
        --bg1: #f8fafc;
        --bg2: #e2e8f0;
        --accent: #2563eb;
        --text: #0f172a;
        --muted: #475569;
        --card: rgba(255,255,255,0.75);
      }
    }
    html, body { height: 100%; }
    body{
      margin: 0;
      background:
        radial-gradient(1200px 600px at 10% 10%, rgba(96,165,250,0.2), transparent 60%),
        radial-gradient(1200px 600px at 90% 90%, rgba(56,189,248,0.18), transparent 60%),
        linear-gradient(160deg, var(--bg1), var(--bg2));
      display: grid;
      place-items: center;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
      color: var(--text);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    .container{ width: min(100%, 900px); padding: clamp(16px, 3vw, 32px); }
    .card{
      backdrop-filter: blur(var(--blur));
      -webkit-backdrop-filter: blur(var(--blur));
      background: var(--card);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: var(--radius);
      padding: clamp(16px, 4vw, 40px);
      box-shadow:
        0 10px 25px rgba(0,0,0,0.25),
        inset 0 1px 0 rgba(255,255,255,0.08);
    }
    h1{
      margin: 0 0 8px;
      font-size: clamp(20px, 4vw, 40px);
      line-height: 1.2;
      letter-spacing: 0.3px;
    }
    .subtitle{
      margin: 0 0 clamp(16px, 3vw, 20px);
      color: var(--muted);
      font-size: clamp(14px, 2.6vw, 18px);
    }
    .timer{
      display: grid;
      grid-template-columns: repeat(4, minmax(0, 1fr));
      gap: clamp(8px, 2vw, 16px);
    }
    @media (max-width: 520px){
      .timer{ grid-template-columns: repeat(2, 1fr); }
    }
    .unit{
      background: rgba(255,255,255,0.06);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 12px;
      text-align: center;
      padding: clamp(12px, 3vw, 20px);
    }
    .value{
      font-variant-numeric: tabular-nums;
      font-size: clamp(32px, 12vw, 72px);
      font-weight: 800;
      line-height: 1.1;
      letter-spacing: 0.02em;
      text-shadow: 0 2px 8px rgba(0,0,0,0.15);
    }
    .label{
      margin-top: 6px;
      color: var(--muted);
      font-size: clamp(12px, 2.5vw, 16px);
      text-transform: lowercase;
      letter-spacing: 0.04em;
    }
    .status{
      margin-top: clamp(12px, 2.5vw, 16px);
      color: var(--muted);
      font-size: clamp(13px, 2.4vw, 16px);
    }
    .hidden{
      position: absolute;
      left: -9999px;
      width: 1px;
      height: 1px;
      overflow: hidden;
    }
    .pulse{ animation: pulse 1.6s ease-in-out infinite; }
    @keyframes pulse{
      0%   { text-shadow: 0 0 0 rgba(96,165,250,0.0); }
      50%  { text-shadow: 0 0 16px rgba(96,165,250,0.6); }
      100% { text-shadow: 0 0 0 rgba(96,165,250,0.0); }
    }
  </style>
</head>
<body>
  <main class="container">
    <section class="card">
      <h1>До переворота календаря осталось…</h1>
      <p class="subtitle">Финиш в 00:00 03.09.2025 (В день, когда горят костры рябин)</p>

      <div class="timer" role="timer" aria-live="polite" aria-atomic="true">
        <div class="unit">
          <div class="value" id="days">00</div>
          <div class="label">дней</div>
        </div>
        <div class="unit">
          <div class="value" id="hours">00</div>
          <div class="label">часов</div>
        </div>
        <div class="unit">
          <div class="value" id="minutes">00</div>
          <div class="label">минут</div>
        </div>
        <div class="unit">
          <div class="value" id="seconds">00</div>
          <div class="label">секунд</div>
        </div>
      </div>

      <p class="status" id="status">Отсчёт идёт…</p>
      <div class="hidden" aria-live="polite" aria-atomic="true" id="sr-status"></div>
    </section>
  </main>

  <script>
    (function(){
      'use strict';

      // Конец: 00:00 03.09.2025 (локальное время устройства)
      // Месяцы: 0=янв ... 8=сентябрь
      const target = new Date(2025, 8, 3, 0, 0, 0);

      const $ = id => document.getElementById(id);
      const el = {
        days: $('days'),
        hours: $('hours'),
        minutes: $('minutes'),
        seconds: $('seconds'),
        status: $('status'),
        sr: $('sr-status')
      };

      // Русские склонения
      const labels = {
        day: ['день','дня','дней'],
        hour: ['час','часа','часов'],
        minute: ['минута','минуты','минут'],
        second: ['секунда','секунды','секунд']
      };

      function plural(n, forms) {
        const n10 = n % 10, n100 = n % 100;
        if (n10 === 1 && n100 !== 11) return forms;
        if (n10 >= 2 && n10 <= 4 && (n100 < 12 || n100 > 14)) return forms[1];
        return forms[2];
      }

      function pad(n){ return String(n).padStart(2, '0'); }

      let lastAnnouncedMinute = null;

      function update(){
        const now = new Date();
        let diff = target - now;

        if (diff <= 0) {
          el.days.textContent    = '00';
          el.hours.textContent   = '00';
          el.minutes.textContent = '00';
          el.seconds.textContent = '00';
          el.status.textContent  = 'Календарь перевернулся!';
          el.status.classList.add('pulse');
          el.sr.textContent = 'Отсчёт завершён';
          return true;
        }

        const totalSeconds = Math.floor(diff / 1000);
        const days    = Math.floor(totalSeconds / 86400);
        const hours   = Math.floor((totalSeconds % 86400) / 3600);
        const minutes = Math.floor((totalSeconds % 3600) / 60);
        const seconds = totalSeconds % 60;

        el.days.textContent    = pad(days);
        el.hours.textContent   = pad(hours);
        el.minutes.textContent = pad(minutes);
        el.seconds.textContent = pad(seconds);

        el.status.textContent =
          `${days} ${plural(days, labels.day)} • ${hours} ${plural(hours, labels.hour)} • ${minutes} ${plural(minutes, labels.minute)} • ${seconds} ${plural(seconds, labels.second)}`;

        // Аудио‑доступность: обновление раз в минуту, чтобы не «болтать» каждую секунду
        if (minutes !== lastAnnouncedMinute) {
          lastAnnouncedMinute = minutes;
          el.sr.textContent =
            `Осталось ${days} ${plural(days, labels.day)}, ${hours} ${plural(hours, labels.hour)} и ${minutes} ${plural(minutes, labels.minute)}`;
        }

        return false;
      }

      // Первый рендер
      update();

      // Интервал 1с + корректировка при возврате на вкладку
      let timerId = setInterval(update, 1000);

      document.addEventListener('visibilitychange', () => {
        if (document.visibilityState === 'visible') {
          update();
          clearInterval(timerId);
          timerId = setInterval(update, 1000);
        }
      });
    })();
  </script>
</body>
</html>
